import {Callout} from "nextra-theme-docs";
import {DataGridMinimalExample} from "../../components/examples/datagrid-minimal-example";
import Preview from "../../components/Preview";

# DataGrid

## Installation

In order to install the component, run the following command:

```shell
npx @rahimstack/chalk-ui add datagrid
```

## Usage

### Define Type

First, you need to define the type of the data that will be displayed.

#### Example

```ts
type Product = {
    id: string
    name: string
    image: string
    visible: boolean
    availability: "in_stock" | "out_of_stock"
    price: number
    category: string | null
}
```

### Column definition

- You can define your columns using the `createDataGridColumns` helper method.
This method takes a callback function that returns an array of type `ColumnDef`.
- [Learn more](https://tanstack.com/table/v8/docs/examples/react/basic) about TanStack Table column definition.

<Callout>
    It is preferable to use `useMemo` to avoid excessive re-rendering and performance issues.
</Callout>

#### Example

```tsx showLineNumbers /createDataGridColumns/
import { createDataGridColumns, DataGrid, DataGridProps } from "@/components/ui/datagrid"

function Demo() {
    const columns = useMemo(() => createDataGridColumns<Product>(() => [
        {
            accessorKey: "name",
            header: "Name",
        },
        ...
    ]), [])

    return (...)
}
```

### Table

#### Example

<Preview contentClassName={"max-w-full"}>
    <DataGridMinimalExample/>
</Preview>

```tsx showLineNumbers
import React, { useEffect, useMemo, useState } from "react"
import { createDataGridColumns, DataGrid } from "@/components/ui/datagrid"
import { fetchFakeData } from "@/components/examples/datagrid-fake-api"

export type Product = {
    id: string
    name: string
    image: string
    visible: boolean
    availability: "in_stock" | "out_of_stock"
    price: number
    category: string | null
}

export function DataGridMinimalExample() {

    const [clientData, setClientData] = useState<Product[] | undefined>(undefined)

    useEffect(() => {
        async function fetch() {
            const res = await fetchFakeData()
            setClientData(res.rows)
        }
        fetch()
    }, [])

    const columns = useMemo(() => createDataGridColumns<Product>(() => [
        {
            accessorKey: "name",
            header: "Name",
            size: 60,
        },
        {
            accessorKey: "price",
            header: "Price",
            cell: info => "$" + Intl.NumberFormat("en-US").format(info.getValue<number>()),
            size: 40,
        },
    ]), [])

    return (
        <>
            <DataGrid<Product>
                columns={columns}
                data={clientData}
                rowCount={clientData?.length ?? 0}
                isLoading={!clientData}
            />
        </>
    )

}
```

#### Loading state

- `isLoading`: When data is coming in for the first time
- `isDataMutating`: When data is already present

#### Initial state

```tsx
<DataGrid<T>
    {...props}
    initialState={{
        globalFilter: "",
        sorting: [],
        pagination: { pageIndex: 0, pageSize: 5 },
        rowSelection: {},
        columnFilters: [],
        columnVisibility: {},
    }}
/>
```
